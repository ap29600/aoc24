in:`I$''0:"10.txt"
d:(#in)/(0 1 0 -1;1 0 -1 0)
m:{(d@/:&'x)+!#x}@+,/'(1_'in,'0N;1_in,0N;-1_'0N,'in;-1_0N,in)=\:1+in
s:,'&0=,/in
p:9{+/'((.x)@&#'p)@=,/p:m@!x}/'s!'1
+/#'p
+/+/'p

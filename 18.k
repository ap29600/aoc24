k:70
in:(k+3)/1++.'0:"18.txt"
bound:@[(*/2#k+3)#0N;(k+3)/,'/1|:\+,/(0,k+2),\:/:!k+3;:;0]

step:{$[~#y;:(x;y;z);::]
  x:@[x;y;:;z]
  y:?(~^x@)_,/(1;-1;k+3;-k+3)+\:y
  (x;y;z+1)}

dist:{{x@(k+3)/2#k+1}@*(step.)/(@[bound;x#in;:;1];,(k+3)/1 1;0)}
dist 1024
`0:","/$-1+(k+3)\in@-1+*{@[y;~r;:;m+r:x m:-2!+/y]}[~^dist@;]/0,#in

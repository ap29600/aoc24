(f;s):.in@=2!!#in:`I$',/0:"9.txt"
m:(+/f)#n:0 1@2!&in
i:{x,|y}.(0,+/~m)_&f
c:{+/x*!#x}
c i@<<m
c 0^*({[x;y;z;w]
  j:*&~((#w)#y)<c:*|w;
  :[^j;(x;y;z;-1_w)
    (@[x;(!c)+/:z@1 0+2*j,-1+#w;:;c#'(-1+#w),0N]
     @[y;j;-;c]
     @[z;1+2*j;+;c]
     -1_w)]}.)/((&f)@<<n;s;0,+\in;f)


(f;s):.in@=2!!#in:`I$',/0:"9.txt"
m:(+/f)#n:0 1@2!&in
i:{x,|y}.(0,+/~m)_&f
c:{+/x*!#x}
c i@<<m
c@*(0 -1 -2 -1_'{[x;y;z;w]
  j:*&~((#w)#y)<c:*|w;
  n:-1+#w
  :[^j;(x;y;z;w)
       (@[x;(!c)+/:z@1 0+2*j,n;:;c#'n,0]
        @[y;j;-;c]
        @[z;1+2*j;+;c]
        w)]}.)/(0^(&f)@<<n;s;0,+\in;f)


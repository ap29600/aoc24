in:0:"8.txt"
w:(#in)\'(=,/in)_"."
b:~&/'0=(0,#in)'
#=b_,/+'{,/((2*x)-\:x)_'!#x}''w
gcd:*(0<*|:)({y,y!x}.)/,
p:{ s:(-gcd.{x|-x}y-x)!'y-x; b_x+/:s*/:,/!'-1 1*0 1+(s&-s)!'#in } 
#=,/,/{p'[,/(|!#x)#','x;,/1_(1_)\x]}'+'w

in:0:"8.txt"
b:~&/'0=(0,#in)'
p:{,/'((|!#x)#'x;1_(1_)\x)}
w:+'p''(#in)\'(=,/in)_"."
m:,'/+/'(,/|:'\(6 -3;1 2))*\:
#?,/{b_+-3!r@\:&&/0=3!r:m x}'w
gcd:*(0<*|:)({y,y!x}.)/,
i:{x*\:(,/!'-1 1*0 1+)'(&/x&-x)!'#in}
#?,/({b_+,/'x+i(-(gcd').{x|-x}s)!'/:s:y-x}.)'w

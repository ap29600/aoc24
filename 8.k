n:#in:0:"8.txt"
b:~&/'0=(0,n)'
w:+'{x@&~|\=#x}''n\'.(=,/in)_"."
m:(6 -3;1 2;2 1;-3 6)
gcd:*|(*:)(|!\)/,
i:{x*\:(,/!'-1 1*0 1+)'(&/x&-x)!'n}
#?,/{b_+-3!r@\:&&/0=3!r:,'/m(+/*)\:x}'w
#?,/({b_+,/'x+i(-(gcd').s|-s)!'/:s:y-x}.)'w

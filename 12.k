adj:,/'in=/:,/2(-1 0 1{,/(x_y;x#0#y)@<0,x}/:\:)/in:0:"12.txt"
p:+/2 1 1 0@2/'adj(1 5;7 3)
c:+/10100100b@2/'adj(1 2 5;5 8 7;7 6 3;3 0 1)
g:.={x@x}/(!#,/in){@[x;,/(x@)\y;:;(x@)/*y]}/,/(0 1;0,#*in)+/:'&'adj 5 7
(#'g)(+/*)/:+/''(p;c)@\:g

